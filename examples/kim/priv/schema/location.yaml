$schema: https://json-schema.org/draft/2020-12/schema

location:
  title: Location
  oneOf:
    - $ref: "#/$defs/Site"
    - $ref: "#/$defs/Building"
    - $ref: "#/$defs/Floor"
    - $ref: "#/$defs/Room"
    - $ref: "#/$defs/RoomSegment"
    - $ref: "#/$defs/SiteSegment"
    - $ref: "#/$defs/Outside"

$defs:
  Location:
    type: object
    title: Abstract Base Location
    properties:
      id:
        type: string
        format: uuid
      name:
        type: string
      number:
        type: number
      adjacent_locations:
        type: array
        items:
          type: string
          format: uuid
      application_functions:
        type: array
        items:
          type: string
          format: uuid
      locations:
        type: array
        items:
          type: string
          format: uuid
      outsides:
        type: array
        items:
          type: string
          format: uuid
      equipments:
        type: array
        items:
          type: string
          format: uuid
      location_usage:
        description: "TODO this should be tag#LocationUsage-enum"
        type: string

    required:
      - id
      - name

  Space:
    title: Abstract Space
    allOf:
      - $ref: "#/$defs/Location"
      - type: object
        title: Space Definition
        properties:
          floor:
            type: string
            format: uuid
          rooms:
            type: array
            items:
              type: string
              format: uuid
          spaces:
            type: array
            items:
              type: string
              format: uuid

  Room:
    title: Room
    allOf:
      - $ref: "#/$defs/Space"
      - type: object
        title: Room Definition
        properties:
          type:
            const: urn:knx:loc.room
          room_segments:
            type: array
            items:
              type: string
              format: uuid

  RoomSegment:
    title: Room Segment
    allOf:
      - $ref: "#/$defs/Space"
      - type: object
        title: Room Segment Definition
        properties:
          type:
            const: urn:knx:loc.roomsegment
          roomSegments:
            type: array
            items:
              type: string
              format: uuid

  Floor:
    title: Floor
    allOf:
      - $ref: "#/$defs/Location"
      - type: object
        title: Floor Definition
        properties:
          type:
            const: urn:knx:loc.floor
          lower_floor:
            type: string
            format: uuid
          upper_floor:
            type: string
            format: uuid
          rooms:
            type: array
            items:
              type: string
              format: uuid
          spaces:
            type: array
            items:
              type: string
              format: uuid

  SiteSegment:
    title: Site Segment
    allOf:
      - $ref: "#/$defs/Location"
      - type: object
        title: Site Segment Definition
        properties:
          type:
            const: urn:knx:loc.sitesegment
          buildings:
            type: array
            items:
              type: string
              format: uuid
          siteSegments:
            type: array
            items:
              type: string
              format: uuid

  Site:
    title: Site
    allOf:
      - $ref: "#/$defs/Location"
      - type: object
        title: Site Definition
        properties:
          type:
            const: urn:knx:loc.site
          buildings:
            type: array
            items:
              type: string
              format: uuid
          siteSegments:
            type: array
            items:
              type: string
              format: uuid

  Building:
    title: Building
    allOf:
      - $ref: "#/$defs/Location"
      - type: object
        title: Building Definition
        properties:
          type:
            const: urn:knx:loc.building
          floors:
            type: array
            items:
              type: string
              format: uuid
          rooms:
            type: array
            items:
              type: string
              format: uuid
          address:
            type: string
          spaces:
            type: array
            items:
              type: string
              format: uuid
        additionalProperties: false

  Outside:
    title: Outside
    allOf:
      - $ref: "#/$defs/Location"
      - type: object
        title: Outside Definition
        properties:
          type:
            const: urn:knx:loc.outside