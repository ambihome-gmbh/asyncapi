{
    "asyncapi": "3.0.0",
    "servers": {
        "production": {
            "host": "10.128.0.5",
            "protocol": "mqtt",
            "description": "Test broker",
            "variables": {
                "port": {
                    "description": "MQTT port",
                    "default": "1883",
                    "enum": [
                        "1883"
                    ]
                }
            }
        }
    },
    "info": {
        "title": "CEMI API â€” Server",
        "version": "0.1",
        "description": "Receives l_data_req; sends l_data_ind (incl. group_resp)."
    },
    "defaultContentType": "application/json",
    "channels": {
        "CEMI_REQ": {
            "address": "CEMI_REQ/{message_code}/{apci}/{dest}",
            "description": "(description)",
            "parameters": {
                "message_code": {
                    "description": "-> payload.message_code"
                },
                "apci": {
                    "description": "-> payload.apci"
                },
                "dest": {
                    "description": "-> payload.dest"
                }
            },
            "messages": {
                "cemi_req": {
                    "name": "cemi_req",
                    "payload": {
                        "$ref": "#/components/schemas/cemi_payload"
                    }
                }
            }
        },
        "CEMI_IND": {
            "address": "CEMI_IND/{message_code}/{apci}/{dest}",
            "description": "(description)",
            "parameters": {
                "message_code": {
                    "description": "-> payload.message_code"
                },
                "apci": {
                    "description": "-> payload.apci"
                },
                "dest": {
                    "description": "-> payload.dest"
                }
            },
            "messages": {
                "cemi_ind": {
                    "name": "cemi_ind",
                    "payload": {
                        "$ref": "#/components/schemas/cemi_payload"
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "cemi_payload": {
                "title": "cEMI Frame",
                "type": "object",
                "additionalProperties": false,
                "properties": {
                    "message_code": {
                        "type": "string",
                        "enum": [
                            "l_data_req",
                            "l_data_ind"
                        ]
                    },
                    "additional_info": {
                        "type": "integer",
                        "enum": [
                            0
                        ],
                        "description": "Always 0 (not yet implemented)"
                    },
                    "ctrl": {
                        "type": "object",
                        "additionalProperties": false,
                        "properties": {
                            "broadcast": {
                                "type": "string",
                                "enum": [
                                    "system_broadcast",
                                    "broadcast"
                                ]
                            },
                            "confirm": {
                                "type": "string",
                                "enum": [
                                    "ok",
                                    "error"
                                ]
                            },
                            "ack": {
                                "type": "string",
                                "enum": [
                                    "no_req_ack",
                                    "req_ack"
                                ]
                            },
                            "addr_t": {
                                "type": "string",
                                "enum": [
                                    "ind",
                                    "grp"
                                ],
                                "description": "Addressing type"
                            },
                            "eff": {
                                "type": "integer",
                                "enum": [
                                    0
                                ],
                                "description": "Always 0 (not yet implemented)"
                            },
                            "frame_type": {
                                "type": "string",
                                "enum": [
                                    "extended",
                                    "standard"
                                ]
                            },
                            "hops": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 7,
                                "description": "Routing hops"
                            },
                            "prio": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 3,
                                "description": "Priority"
                            },
                            "repeat": {
                                "type": "string",
                                "enum": [
                                    "repeat_on_error",
                                    "do_not_repeat"
                                ]
                            }
                        },
                        "required": [
                            "broadcast",
                            "confirm",
                            "ack",
                            "addr_t",
                            "eff",
                            "frame_type",
                            "hops",
                            "prio",
                            "repeat"
                        ]
                    },
                    "src": {
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 65535,
                        "description": "Source address"
                    },
                    "dest": {
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 65535,
                        "description": "Destination address"
                    },
                    "apci": {
                        "type": "string",
                        "enum": [
                            "group_read",
                            "group_resp",
                            "group_write"
                        ]
                    },
                    "data": {
                        "type": "string",
                        "contentEncoding": "base64",
                        "description": "Full APDU including APCI (raw bytes), base64-encoded"
                    }
                },
                "required": [
                    "message_code",
                    "additional_info",
                    "ctrl",
                    "src",
                    "dest",
                    "apci",
                    "data"
                ]
            }
        }
    }
}