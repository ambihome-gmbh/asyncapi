{"asyncapi":"3.0.0","info":{"title":"Scenes API","version":"0.2","description":"Coboservices Scene API description - server perspective"},"x-testcases":[{"name":"create scene","sequence":["user->service: scn_add/{id: 'x', name: 'S1', member_channels: ['ch1', 'ch2']}","service->user: scn_info_state[scene_id: id]/{name: 'S1'}","user->service: scn_update[scene_id: $id]/{id: $id, name: 'S11', member_channels: ['ch1', 'ch2']}","service->user: scn_info_state[scene_id: $id]/{name: 'S11'}"]}],"defaultContentType":"application/json","servers":{"production":{"host":"127.0.0.1","protocol":"mqtt","variables":{"port":{"default":"1883","enum":["1883"]}}}},"channels":{"SCN_CMD_ADD":{"address":"SCN/CMD_ADD","messages":{"add":{"name":"ADD","payload":{"type":"object","additionalProperties":false,"properties":{"id":{"description":"Scene ID - TODO trait that overwrites this with null for cmd-add","type":"string"},"name":{"description":"Scene name","type":"string"},"member_channels":{"description":"channel ids of the scene members","type":"array","minItems":1,"uniqueItems":true,"items":{"type":"string"}},"fixed":{"description":"Scene is fixed","type":"boolean","default":false},"fixed_type":{"description":"scene fixed to min or max values","type":"string","default":"fixed_type_none","enum":["fixed_type_min","fixed_type_max","fixed_type_none"]},"static":{"description":"Scene is static","type":"boolean","default":false}},"required":["id","name","member_channels"],"examples":[{"name":"Sample Scene Name","member_channels":["channel_3","channel_14"]}]}}},"description":"Add a new scene. A new `scene_id` is created by the service. Publishes `SCN_INFO_STATE/{scene_id}`."},"SCN_CMD_CALL":{"address":"SCN/CMD_CALL/{scene_id}","messages":{"call":{"name":"CALL","payload":{"type":"object","additionalProperties":false,"properties":{"_sender":{"description":"sender uuid","type":"string"}}}}},"description":"Call scene with ID `scene_id`. The scene must exist and must not be an undo-scene. When a scene is called, the stored value for each member is sent to the bus. The scene's undo-scene is deleted. New undo-scene is created. Publishes `SCN/INFO_STATE/{scene_id}`.","parameters":{"scene_id":{"description":"ID of a scene."}}},"SCN_CMD_DELETE":{"address":"SCN/CMD_DELETE/{scene_id}","messages":{"delete":{"name":"DELETE","payload":{"type":"object","additionalProperties":false,"properties":{"_sender":{"description":"sender uuid","type":"string"}}}}},"description":"Delete scene with ID `scene_id`. The scene must exist and must not be an undo-scene. The scene's undo-scene is deleted. Publishes `SCN/INFO_DELETED/{scene_id}`.","parameters":{"scene_id":{"description":"ID of a scene."}}},"SCN_CMD_GET_ALL_INFO":{"address":"SCN/CMD_GET_ALL_INFO","messages":{"get_all_info":{"name":"GET_ALL_INFO","payload":{"type":"object","additionalProperties":false,"properties":{"_sender":{"description":"sender uuid","type":"string"}}}}},"description":"Request status of all scenes. Publishes `SCN/INFO_STATE/{scene_id}` for all scenes."},"SCN_CMD_GET_INFO":{"address":"SCN/CMD_GET_INFO/{scene_id}","messages":{"get_info":{"name":"GET_INFO","payload":{"type":"object","additionalProperties":false,"properties":{"_sender":{"description":"sender uuid","type":"string"}}}}},"description":"Request status of scene with ID `scene_id`. The scene must exist and must not be an undo-scene. Publishes `SCN/INFO_STATE/{scene_id}`.","parameters":{"scene_id":{"description":"ID of a scene."}}},"SCN_CMD_LEARN":{"address":"SCN/CMD_LEARN/{scene_id}","messages":{"learn":{"name":"LEARN","payload":{"type":"object","additionalProperties":false,"properties":{"_sender":{"description":"sender uuid","type":"string"}}}}},"description":"Learn scene with ID `scene_id`. The scene must exist and must not be an undo-scene. When a scene is learned the current state of all members is stored. Publishes `SCN/INFO_STATE/{scene_id}`.","parameters":{"scene_id":{"description":"ID of a scene."}}},"SCN_CMD_UNDO_SCENE":{"address":"SCN/CMD_UNDO_SCENE/{scene_id}","messages":{"undo":{"name":"UNDO","payload":{"type":"object","additionalProperties":false,"properties":{"_sender":{"description":"sender uuid","type":"string"}}}}},"description":"Call undo-scene of scene with ID `scene_id`. The scene must exist and must not be an undo-scene. The must have been called once, so that an undo-scene exists. The called undo-scene is then deleted.","parameters":{"scene_id":{"description":"ID of a scene."}}},"SCN_CMD_UPDATE":{"address":"SCN/CMD_UPDATE/{scene_id}","messages":{"update":{"name":"UPDATE","payload":{"type":"object","additionalProperties":false,"properties":{"id":{"description":"Scene ID - TODO trait that overwrites this with null for cmd-add","type":"string"},"name":{"description":"Scene name","type":"string"},"member_channels":{"description":"channel ids of the scene members","type":"array","minItems":1,"uniqueItems":true,"items":{"type":"string"}},"fixed":{"description":"Scene is fixed","type":"boolean","default":false},"fixed_type":{"description":"scene fixed to min or max values","type":"string","default":"fixed_type_none","enum":["fixed_type_min","fixed_type_max","fixed_type_none"]},"static":{"description":"Scene is static","type":"boolean","default":false}},"required":["id","name","member_channels"],"examples":[{"name":"Sample Scene Name","member_channels":["channel_3","channel_14"]}]}}},"description":"Update name and members of scene with ID `scene_id`. All members and their stored values are deleted and then the given members are added. The fixed attribute cannot be changed.","parameters":{"scene_id":{"description":"ID of a scene."}}},"SCN_INFO_STATE":{"address":"SCN/INFO_STATE/{scene_id}","messages":{"info":{"name":"INFO_STATE","payload":{"type":"object","additionalProperties":false,"properties":{"id":{"description":"Scene ID - TODO trait that overwrites this with null for cmd-add","type":"string"},"name":{"description":"Scene name","type":"string"},"member_channels":{"description":"channel ids of the scene members","type":"array","minItems":1,"uniqueItems":true,"items":{"type":"string"}},"fixed":{"description":"Scene is fixed","type":"boolean","default":false},"fixed_type":{"description":"scene fixed to min or max values","type":"string","default":"fixed_type_none","enum":["fixed_type_min","fixed_type_max","fixed_type_none"]},"static":{"description":"Scene is static","type":"boolean","default":false}},"required":["id","name","member_channels"],"examples":[{"name":"Sample Scene Name","member_channels":["channel_3","channel_14"]}]}}},"description":"State of scene with ID `scene_id`.","parameters":{"scene_id":{"description":"ID of a scene."}}},"SCN_INFO_DELETED":{"address":"SCN/INFO_DELETED/{scene_id}","messages":{"deleted":{"name":"INFO_DELETED","payload":{"type":"object","additionalProperties":false,"properties":{"_sender":{"description":"sender uuid","type":"string"}}}}},"description":"The scene with ID `scene_id` was deleted.","parameters":{"scene_id":{"description":"ID of a scene."}}},"SCN_ERROR":{"address":"SCN/ERROR","messages":{"error":{"name":"ERROR","payload":{"type":"object","additionalProperties":false,"properties":{"_sender":{"description":"sender uuid","type":"string"}}}}},"description":"some error occurred, back to sender. TODO payload, needs sender trait"},"GrpVal_Write_req":{"address":"ambid/to_KNX/{group_address}/GrpVal_Write/req","messages":{"ambid_to_knx":{"name":"to_knx","title":"Message to KNX","contentType":"application/json","payload":{"type":"object","additionalProperties":false,"properties":{"Value":{"anyOf":[{"type":"number","description":"If possible all DPTs are decoded as numbers."},{"type":"string","description":"Some like Text and Date/Time DPTs are strings. TODO: format of complex DPT like Date/Time"}]},"Unit":{"description":"Optional unit of the value. Ignored if sent to KNX.","type":"string"},"Ctrl":{"description":"cEMI control-flags","type":"string"},"Src":{"description":"source address","type":"string"},"Dpt":{"description":"datapoint type","type":"string"}}}}},"description":"Request to write a value to `group_address`.","parameters":{"group_address":{"description":"group_address"}}},"GrpVal_Read_req":{"address":"ambid/to_KNX/{group_address}/GrpVal_Read/req","messages":{"ambid_to_knx":{"name":"to_knx","title":"Message to KNX","contentType":"application/json","payload":{"type":"object","additionalProperties":false,"properties":{"Value":{"anyOf":[{"type":"number","description":"If possible all DPTs are decoded as numbers."},{"type":"string","description":"Some like Text and Date/Time DPTs are strings. TODO: format of complex DPT like Date/Time"}]},"Unit":{"description":"Optional unit of the value. Ignored if sent to KNX.","type":"string"},"Ctrl":{"description":"cEMI control-flags","type":"string"},"Src":{"description":"source address","type":"string"},"Dpt":{"description":"datapoint type","type":"string"}}}}},"description":"Read the value of `group-address`. Used by the state-service to initialize after server reboot.","parameters":{"group_address":{"description":"group_address"}}},"GrpVal_Write_ind":{"address":"ambid/from_KNX/{group_address}/GrpVal_Write/ind","messages":{"ambid_from_knx":{"name":"from_knx","title":"Message from KNX","contentType":"application/json","payload":{"type":"object","additionalProperties":false,"properties":{"Value":{"anyOf":[{"type":"number","description":"If possible all DPTs are decoded as numbers."},{"type":"string","description":"Some like Text and Date/Time DPTs are strings. TODO: format of complex DPT like Date/Time"}]},"Unit":{"description":"Optional unit of the value. Ignored if sent to KNX.","type":"string"},"Ctrl":{"description":"cEMI control-flags","type":"string"},"Src":{"description":"source address","type":"string"},"Dpt":{"description":"datapoint type","type":"string"}}}}},"description":"A KNX device has written a value to `group-address`.","parameters":{"group_address":{"description":"group_address"}}},"GrpVal_Resp_ind":{"address":"ambid/from_KNX/{group_address}/GrpVal_Resp/ind","messages":{"ambid_from_knx":{"name":"from_knx","title":"Message from KNX","contentType":"application/json","payload":{"type":"object","additionalProperties":false,"properties":{"Value":{"anyOf":[{"type":"number","description":"If possible all DPTs are decoded as numbers."},{"type":"string","description":"Some like Text and Date/Time DPTs are strings. TODO: format of complex DPT like Date/Time"}]},"Unit":{"description":"Optional unit of the value. Ignored if sent to KNX.","type":"string"},"Ctrl":{"description":"cEMI control-flags","type":"string"},"Src":{"description":"source address","type":"string"},"Dpt":{"description":"datapoint type","type":"string"}}}}},"description":"A KNX device responds to a GrpVal_Read.req to `group-address`. Used by the state-service to initialize after server reboot.","parameters":{"group_address":{"description":"group_address"}}}},"operations":{"GrpVal_Write_req":{"action":"send","channel":{"$ref":"#/channels/GrpVal_Write_req"}},"add":{"action":"receive","channel":{"$ref":"#/channels/SCN_CMD_ADD"},"reply":{"channel":{"$ref":"#/channels/SCN_INFO_STATE"}}},"call":{"action":"receive","channel":{"$ref":"#/channels/SCN_CMD_CALL"}},"delete":{"action":"receive","channel":{"$ref":"#/channels/SCN_CMD_DELETE"},"reply":{"channel":{"$ref":"#/channels/SCN_INFO_DELETED"}}},"get_all_info":{"action":"receive","channel":{"$ref":"#/channels/SCN_CMD_GET_ALL_INFO"},"reply":{"channel":{"$ref":"#/channels/SCN_INFO_STATE"}}},"get_info":{"action":"receive","channel":{"$ref":"#/channels/SCN_CMD_GET_INFO"},"reply":{"channel":{"$ref":"#/channels/SCN_INFO_STATE"}}},"learn":{"action":"receive","channel":{"$ref":"#/channels/SCN_CMD_LEARN"}},"undo":{"action":"receive","channel":{"$ref":"#/channels/SCN_CMD_UNDO_SCENE"}},"update":{"action":"receive","channel":{"$ref":"#/channels/SCN_CMD_UPDATE"},"reply":{"channel":{"$ref":"#/channels/SCN_INFO_STATE"}}},"info_deleted":{"action":"send","channel":{"$ref":"#/channels/SCN_INFO_DELETED"}},"info_state":{"action":"send","channel":{"$ref":"#/channels/SCN_INFO_STATE"}},"error":{"action":"send","channel":{"$ref":"#/channels/SCN_ERROR"}}},"components":{"schemas":{"empty_payload":{"type":"object","additionalProperties":false,"properties":{"_sender":{"description":"sender uuid","type":"string"}}},"scn_config_payload":{"type":"object","additionalProperties":false,"properties":{"id":{"description":"Scene ID - TODO trait that overwrites this with null for cmd-add","type":"string"},"name":{"description":"Scene name","type":"string"},"member_channels":{"description":"channel ids of the scene members","type":"array","minItems":1,"uniqueItems":true,"items":{"type":"string"}},"fixed":{"description":"Scene is fixed","type":"boolean","default":false},"fixed_type":{"description":"scene fixed to min or max values","type":"string","default":"fixed_type_none","enum":["fixed_type_min","fixed_type_max","fixed_type_none"]},"static":{"description":"Scene is static","type":"boolean","default":false}},"required":["id","name","member_channels"],"examples":[{"name":"Sample Scene Name","member_channels":["channel_3","channel_14"]}]},"ambid_payload":{"type":"object","additionalProperties":false,"properties":{"Value":{"anyOf":[{"type":"number","description":"If possible all DPTs are decoded as numbers."},{"type":"string","description":"Some like Text and Date/Time DPTs are strings. TODO: format of complex DPT like Date/Time"}]},"Unit":{"description":"Optional unit of the value. Ignored if sent to KNX.","type":"string"},"Ctrl":{"description":"cEMI control-flags","type":"string"},"Src":{"description":"source address","type":"string"},"Dpt":{"description":"datapoint type","type":"string"}}}},"parameters":{"scene_id":{"description":"ID of a scene."},"group_address":{"description":"group_address"}},"messages":{"ambid_to_knx":{"name":"to_knx","title":"Message to KNX","contentType":"application/json","payload":{"type":"object","additionalProperties":false,"properties":{"Value":{"anyOf":[{"type":"number","description":"If possible all DPTs are decoded as numbers."},{"type":"string","description":"Some like Text and Date/Time DPTs are strings. TODO: format of complex DPT like Date/Time"}]},"Unit":{"description":"Optional unit of the value. Ignored if sent to KNX.","type":"string"},"Ctrl":{"description":"cEMI control-flags","type":"string"},"Src":{"description":"source address","type":"string"},"Dpt":{"description":"datapoint type","type":"string"}}}},"ambid_from_knx":{"name":"from_knx","title":"Message from KNX","contentType":"application/json","payload":{"type":"object","additionalProperties":false,"properties":{"Value":{"anyOf":[{"type":"number","description":"If possible all DPTs are decoded as numbers."},{"type":"string","description":"Some like Text and Date/Time DPTs are strings. TODO: format of complex DPT like Date/Time"}]},"Unit":{"description":"Optional unit of the value. Ignored if sent to KNX.","type":"string"},"Ctrl":{"description":"cEMI control-flags","type":"string"},"Src":{"description":"source address","type":"string"},"Dpt":{"description":"datapoint type","type":"string"}}}}}}}